<div class="min-h-screen bg-gray-50 py-8 container mx-auto px-4">

  <!-- Validation Changes Table -->
  <div *ngIf="changes.length > 0" class="mb-8 bg-yellow-50 border border-yellow-200 rounded-xl p-6">
    <h2 class="text-xl font-semibold text-yellow-800 mb-4">‚ö†Ô∏è Cart Changes Detected</h2>
    
    <table class="w-full text-left border-collapse">
      <thead>
        <tr class="bg-yellow-100">
          <th class="p-3">Product</th>
          <th class="p-3">Change</th>
          <th class="p-3 text-right">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let change of changes" class="border-t">
          <td class="p-3 font-medium">{{ change.title }}</td>
          <td class="p-3 text-gray-700">{{ change.message }}</td>
          <td class="p-3 text-right space-x-2">
            
            <!-- Accept Button -->
            <button *ngIf="change.type !== 'outOfStock'" 
                    (click)="acceptChange(change)"
                    class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg">
              {{ change.type === 'priceChanged' ? 'Accept New Price' : 'Update Quantity' }}
            </button>

            <!-- Remove Button -->
            <button (click)="rejectChange(change)"
                    class="px-4 py-2 bg-rose-500 hover:bg-rose-600 text-white rounded-lg">
              Remove
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty Cart -->
  <div *ngIf="cart.items.length === 0 && (!changes || changes.length === 0)" class="text-center py-16">
    <div class="text-gray-400 mb-4">üõçÔ∏è</div>
    <h2 class="text-2xl font-semibold text-gray-800 mb-2">Your cart is empty</h2>
    <p class="text-gray-600 mb-6">Discover our amazing products and start shopping!</p>
    <a routerLink="/products"
       class="inline-flex items-center bg-rose-500 hover:bg-rose-600 text-white px-6 py-3 rounded-lg font-semibold">
      ‚Üê Continue Shopping
    </a>
  </div>

  <!-- Cart Items -->
  <div *ngIf="cart.items.length > 0" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    
    <!-- Items List -->
    <div class="lg:col-span-2 bg-white rounded-xl shadow-sm overflow-hidden">
      <div class="p-6 border-b border-gray-200">
        <h2 class="text-xl font-semibold text-gray-800">Cart Items ({{ cart.items.length }})</h2>
      </div>
      <div class="divide-y divide-gray-200">
        <div *ngFor="let item of cart.items" class="p-6 flex gap-4">
          <img [src]="item.product.image" [alt]="item.product.title" class="w-20 h-20 object-cover rounded-lg"/>
          <div class="flex-1">
            <h3 class="font-semibold text-gray-800 mb-1">{{ item.product.title }}</h3>
            <p class="text-gray-600">Price: ${{ item.price }}</p>
            <p class="text-gray-800 font-semibold">Subtotal: ${{ item.subtotal }}</p>
          </div>
          <div class="flex flex-col items-end gap-3">
            <div class="flex items-center border border-gray-300 rounded-lg">
              <button (click)="updateQuantity(item.product._id, item.quantity - 1)" class="p-2 hover:bg-gray-100">-</button>
              <span class="px-4 py-2 font-medium">{{ item.quantity }}</span>
              <button (click)="updateQuantity(item.product._id, item.quantity + 1)" class="p-2 hover:bg-gray-100">+</button>
            </div>
            <button (click)="removeItem(item.product._id)" class="p-2 text-gray-400 hover:text-rose-500">üóëÔ∏è</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Order Summary -->
    <div class="lg:col-span-1 bg-white rounded-xl shadow-sm p-6 sticky top-24">
      <h2 class="text-xl font-semibold text-gray-800 mb-6">Order Summary</h2>

      <div class="flex justify-between mb-6 text-lg font-medium">
        <span>Total:</span>
        <span>${{ cart.totalPrice }}</span>
      </div>

      <button (click)="placeOrder()"
              class="w-full mb-3 bg-rose-500 hover:bg-rose-600 text-white py-4 rounded-lg font-semibold">
        Place Order
      </button>
      <button (click)="clearCart()"
              class="w-full border border-gray-300 hover:bg-gray-50 text-gray-700 py-4 rounded-lg font-semibold">
        Clear Cart
      </button>
    </div>
  </div>
</div>
